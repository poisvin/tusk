<%
  preset_colors = ['#135bec', '#ef4444', '#22c55e', '#f59e0b', '#8b5cf6', '#ec4899', '#06b6d4', '#64748b']
%>

<% if mobile? %>
  <%= render "shared/header", title: "Settings", left_icon: "settings" %>
<% end %>

<main class="flex-1 <%= 'pb-24' if mobile? %>">
  <!-- Notifications Section -->
  <section class="p-4 border-b border-slate-800" data-controller="notifications">
    <h3 class="text-white text-lg font-bold mb-4">Notifications</h3>
    <div data-notifications-target="status">
      <!-- Content will be dynamically inserted by Stimulus -->
    </div>
  </section>

  <!-- Tags Section -->
  <section class="p-4">
    <h3 class="text-white text-lg font-bold mb-4">Tags</h3>

    <!-- Existing Tags -->
    <div class="space-y-2 mb-4">
      <% if @tags.empty? %>
        <p class="text-slate-400 text-sm">No tags created yet</p>
      <% else %>
        <% @tags.each do |tag| %>
          <div class="flex items-center gap-3 bg-slate-800/50 rounded-lg p-3">
            <div
              class="w-4 h-4 rounded-full shrink-0"
              style="background-color: <%= tag.color || '#135bec' %>"
            ></div>
            <span class="flex-1 text-white"><%= tag.name %></span>
            <%= link_to edit_tag_path(tag),
                class: "text-slate-400 hover:text-white",
                data: { turbo_frame: "modal-content" } do %>
              <span class="material-symbols-outlined text-lg">edit</span>
            <% end %>
            <%= button_to tag_path(tag),
                method: :delete,
                form: { data: { turbo_confirm: "Delete this tag? It will be removed from all tasks." } },
                class: "text-slate-400 hover:text-red-500" do %>
              <span class="material-symbols-outlined text-lg">delete</span>
            <% end %>
          </div>
        <% end %>
      <% end %>
    </div>

    <!-- Add New Tag -->
    <div class="bg-slate-800/30 rounded-lg p-4" data-controller="tag-color">
      <p class="text-slate-400 text-sm mb-3">Create new tag</p>
      <%= form_with url: tags_path, method: :post, local: true do |f| %>
        <div class="flex gap-2 mb-3">
          <% preset_colors.each_with_index do |color, i| %>
            <button
              type="button"
              data-action="tag-color#select"
              data-color="<%= color %>"
              data-tag-color-target="button"
              class="w-8 h-8 rounded-full transition-all <%= 'ring-2 ring-white ring-offset-2 ring-offset-background-dark' if i == 0 %>"
              style="background-color: <%= color %>"
            ></button>
          <% end %>
        </div>
        <%= hidden_field_tag 'tag[color]', preset_colors.first, data: { tag_color_target: "field" } %>
        <div class="flex gap-2">
          <%= text_field_tag 'tag[name]', nil,
              placeholder: "Tag name",
              class: "flex-1 bg-slate-800/50 border border-slate-700 rounded-lg px-4 py-2 text-white placeholder-slate-500 focus:outline-none focus:border-primary" %>
          <%= submit_tag "Add",
              class: "bg-primary text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-600 transition-colors cursor-pointer" %>
        </div>
      <% end %>
    </div>
  </section>

  <!-- About Section -->
  <section class="p-4 border-t border-slate-800">
    <h3 class="text-white text-lg font-bold mb-4">About</h3>
    <div class="text-slate-400 text-sm space-y-2">
      <p>Tusk - Personal Task Manager</p>
      <p>Version 1.0.0</p>
    </div>
  </section>
</main>
